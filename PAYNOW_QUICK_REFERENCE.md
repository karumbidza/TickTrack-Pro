# Paynow Integration - Quick Visual Summary

## ONE-PAGE SUMMARY: Where Users Click to Access Paynow

### ğŸ‘‡ THE FLOW IN 3 SCREENS

---

## SCREEN 1: Billing Page (TickTrack)

```
URL: https://ticktrackpro.com/billing

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 Billing & Subscription                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  Current Subscription: TRIAL                           â”‚
â”‚  Status: Active (5 days remaining)                     â”‚
â”‚                                                         â”‚
â”‚  Plan: Basic                                            â”‚
â”‚  Price: Free (Trial)                                    â”‚
â”‚                                                         â”‚
â”‚              â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—               â”‚
â”‚              â•‘    âœ“ Upgrade Now        â•‘ â† CLICK THIS  â”‚
â”‚              â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•               â”‚
â”‚                                                         â”‚
â”‚  Or click "Change Plan" button below...                â”‚
â”‚                                                         â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚  Payment History                                        â”‚
â”‚  (None yet)                                             â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**User Action:** Clicks "Upgrade Now" or "Change Plan"

---

## SCREEN 2: Upgrade Dialog (Still TickTrack)

```
Dialog Modal Opens:

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘         Upgrade Your Plan                              â•‘
â•‘  Select a plan and payment method to continue          â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                        â•‘
â•‘  Select Plan                                           â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â•‘
â•‘  â”‚ Basic   â”‚  â”‚ Pro  â”‚  â”‚ â—  Enterprise        â”‚     â•‘
â•‘  â”‚ $29/mo  â”‚  â”‚$79/moâ”‚  â”‚ Full-featured  $199  â”‚     â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”˜  â”‚ Popular â–²            â”‚     â•‘
â•‘                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â•‘
â•‘                                                        â•‘
â•‘  Billing Cycle                                         â•‘
â•‘  â—  Monthly          â—‹ Yearly (-17% discount)        â•‘
â•‘                                                        â•‘
â•‘  Payment Method                                        â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â•‘
â•‘  â”‚ â— Paynow (Mobile Money)                      â”‚    â•‘
â•‘  â”‚   Ecocash, OneMoney, Telecash                â”‚    â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â•‘
â•‘                                                        â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â•‘
â•‘  â”‚ â—‹ Bank Transfer                              â”‚    â•‘
â•‘  â”‚   Direct bank deposit                        â”‚    â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â•‘
â•‘                                                        â•‘
â•‘       [Cancel]     â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—     â•‘
â•‘                    â•‘ Continue to Payment        â•‘ â†   â•‘
â•‘                    â•‘ (Paynow)                   â•‘ CLICKâ•‘
â•‘                    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•     â•‘
â•‘                                                        â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

**User Action:** 
1. Selects "Enterprise" plan
2. Selects "Monthly" billing
3. Selects "Paynow (Mobile Money)" 
4. **Clicks "Continue to Payment"** â† CRITICAL CLICK

---

## SCREEN 3: Paynow Payment Page (NOT Your App)

```
Browser redirects to:
https://www.paynow.co.zw/payment/xyz789...

(This is Paynow's hosted payment page, not your domain)

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘           PAYNOW PAYMENT GATEWAY                       â•‘
â•‘                (Paynow's servers)                      â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                        â•‘
â•‘  ORDER SUMMARY                                         â•‘
â•‘  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â•‘
â•‘  TickTrack Pro Enterprise - Monthly                   â•‘
â•‘  Amount: USD $199.00                                   â•‘
â•‘  Processing Fee: USD $0.00                            â•‘
â•‘  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â•‘
â•‘  TOTAL: USD $199.00                                    â•‘
â•‘                                                        â•‘
â•‘  SELECT PAYMENT METHOD                                 â•‘
â•‘  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â•‘
â•‘                                                        â•‘
â•‘  ğŸ’³ CARD PAYMENTS                                      â•‘
â•‘  â—‹ Visa Card                                           â•‘
â•‘  â—‹ Mastercard                                          â•‘
â•‘                                                        â•‘
â•‘  ğŸ“± MOBILE MONEY (POPULAR)                             â•‘
â•‘  â— EcoCash (Econet) â† DEFAULT SELECTED               â•‘
â•‘  â—‹ OneMoney (Vodafone)                                â•‘
â•‘  â—‹ Telecash (NetOne)                                  â•‘
â•‘  â—‹ InnBucks                                            â•‘
â•‘                                                        â•‘
â•‘  ğŸ¦ BANK TRANSFERS                                     â•‘
â•‘  â—‹ ZIM-Switch                                          â•‘
â•‘                                                        â•‘
â•‘       [â† Back]      â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—        â•‘
â•‘                     â•‘  Proceed with EcoCash  â•‘        â•‘
â•‘                     â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•        â•‘
â•‘                                                        â•‘
â•‘  (Payment methods selected here, NOT in your app)    â•‘
â•‘  (Card details entered here, NOT in your app)        â•‘
â•‘  (All secure - PCI DSS compliant)                    â•‘
â•‘                                                        â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

**User Actions:**
1. Sees all available payment methods
2. Can select different method if desired
3. Clicks "Proceed with [Method]"
4. Enters payment credentials (phone/PIN/card)
5. Payment processes securely

---

## ğŸ”„ What Happens Next (Behind the Scenes)

```
PAYNOW SIDE (User doesn't see this)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Payment processes               â”‚
â”‚ (EcoCash, Vodafone, etc)        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
WEBHOOK NOTIFICATION (Your Backend)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Paynow POSTs to your API        â”‚
â”‚ /api/payments/paynow/webhook    â”‚
â”‚                                 â”‚
â”‚ Status: "complete"              â”‚
â”‚ Amount: 199 USD                 â”‚
â”‚ Reference: SUB-xxx-1705256100   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
YOUR APP (Backend)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Verifies webhook hash           â”‚
â”‚ Updates payment status          â”‚
â”‚ Activates subscription          â”‚
â”‚ Sends confirmation email        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
USER REDIRECT
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Paynow redirects user to:       â”‚
â”‚ /billing/payment/return         â”‚
â”‚                                 â”‚
â”‚ User sees:                      â”‚
â”‚ "âœ“ Payment Successful!"         â”‚
â”‚ "Subscription Active"           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Key Points

### âœ… What You're NOT Doing
- âœ— NOT showing payment methods (Paynow shows them)
- âœ— NOT collecting card numbers (Paynow collects them)
- âœ— NOT storing payment details (Paynow stores them)
- âœ— NOT processing payments (Paynow processes them)

### âœ… What You ARE Doing
- âœ“ Collecting plan selection
- âœ“ Creating payment on backend
- âœ“ Sending to Paynow API
- âœ“ Getting redirect URL from Paynow
- âœ“ Redirecting user to Paynow
- âœ“ Receiving webhook confirmation
- âœ“ Activating subscription

### ğŸ”’ Security
- **PCI DSS Compliant** - Your app never touches card data
- **HTTPS Only** - All communication encrypted
- **Hash Verified** - Webhooks authenticated
- **Hosted Gateway** - Paynow handles sensitive data

---

## Code References

### The Critical Redirect (Frontend)
**File:** [app/billing/page.tsx](app/billing/page.tsx#L735-L750)

```typescript
<Button onClick={() => handleUpgrade()}>
  Continue to Payment
</Button>

// This calls:
const handleUpgrade = async () => {
  const response = await fetch('/api/billing/paynow/initiate', {...})
  const {redirectUrl} = await response.json()
  
  // â† THIS LINE SENDS USER TO PAYNOW:
  window.location.href = redirectUrl
}
```

### Backend Creates Payment
**File:** [app/api/billing/paynow/initiate/route.ts](app/api/billing/paynow/initiate/route.ts#L100-L135)

```typescript
// Create payment with Paynow SDK
const paynowPayment = paynow.createPayment(reference, email)
paynowPayment.add('TickTrack Pro Enterprise - monthly', 199)

// Send to Paynow - get redirectUrl
const response = await paynow.send(paynowPayment)

// Return redirectUrl to frontend
return {redirectUrl: response.redirectUrl}
```

### Webhook Handler
**File:** [app/api/payments/paynow/webhook/route.ts](app/api/payments/paynow/webhook/route.ts)

```typescript
// Paynow POSTs payment confirmation here
export async function POST(request: NextRequest) {
  const webhookData = await request.json()
  
  // Verify it's from Paynow
  const isValid = paynow.verifyHash(webhookData, webhookData.hash)
  
  // Activate subscription
  if (isValid && webhookData.status === 'complete') {
    await activateSubscription(webhookData.reference)
  }
}
```

---

## Timeline

```
00:00  User on /billing page
  â†“
00:05  Clicks "Upgrade Now"
  â†“
00:10  Dialog opens - selects Enterprise, Monthly, Paynow
  â†“
00:15  âœ“ Clicks "Continue to Payment" (Still on your domain)
  â†“
00:20  Browser POST â†’ /api/billing/paynow/initiate
  â†“
00:25  Backend calls paynow.send()
  â†“
00:30  Backend returns {redirectUrl}
  â†“
00:35  âœ“ window.location.href = redirectUrl
  â†“
00:40  âœ“ USER LEAVES YOUR DOMAIN (now on Paynow)
  â†“
00:45  User selects EcoCash on Paynow page
  â†“
00:50  User enters phone & PIN on Paynow
  â†“
01:00  Payment processed by EcoCash provider
  â†“
01:05  Paynow POSTs webhook to your API
  â†“
01:10  Your backend activates subscription
  â†“
01:15  Paynow redirects user back to your app
  â†“
01:20  âœ“ User sees "Payment Successful!"
```

---

## Direct Answer to Your Question

### "Where exactly do we click and go to Paynow?"

**Answer:** 
The **"Continue to Payment"** button in the Upgrade Dialog triggers the redirect.

**Technical Path:**
```
User Clicks "Continue to Payment" Button
    â†“
handleUpgrade() function in app/billing/page.tsx
    â†“
POST /api/billing/paynow/initiate (to backend)
    â†“
Backend creates payment with paynow.send()
    â†“
Paynow returns redirectUrl
    â†“
Frontend executes: window.location.href = redirectUrl
    â†“
BROWSER NAVIGATES TO PAYNOW.CO.ZW
```

**User's Perspective:**
1. Fills form (plan, cycle, payment method)
2. Clicks **"Continue to Payment"** â† **THIS IS THE CLICK**
3. Page briefly loads (showing "Processing...")
4. Browser redirects to Paynow
5. Sees Paynow payment page with all payment methods
6. Selects & completes payment on Paynow
7. Returns to your app

---

**The key insight:** Your app only handles steps 1-2 and 7. Steps 3-6 are 100% Paynow's responsibility.

---

Generated: January 14, 2026
